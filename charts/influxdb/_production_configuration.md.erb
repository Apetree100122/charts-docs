<%
=begin
apps: influxdb
platforms: kubernetes
id: production_configuration
title: Production configuration and horizontal scaling
category: configuration
weight: 20
highlight: 20
=end %>

This chart includes a values-production.yaml file where you can find some parameters oriented to production configuration in comparison to the regular values.yaml. You can use this file instead of the default one.

* Use the high-availability architecture:

    - architecture: standalone
    + architecture: high-availability

* Increase the number of InfluxDB and InfluxDB Relay replicas:

    - influxdb.replicaCount: 1
    + influxdb.replicaCount: 3
    - relay.replicaCount: 1 # were actually ignored in standalone architecture
    + relay.replicaCount: 2

* Enable Prometheus metrics:

    - metrics.enabled: false
    + metrics.enabled: true

* Enable Newtworkpolicy blocking external access:

    - networkPolicy.enabled: false
    + networkPolicy.enabled: true
    - networkPolicy.allowExternal: true
    + networkPolicy.allowExternal: false

To horizontally scale this chart once it has been deployed (only available in the high-availability architecture), you can use the following parameters:

~~~
influxdb.replicaCount=3
relay.replicaCount=2
~~~

### Use custom configuration

This Helm chart supports to customize the whole configuration file.

Add your custom configuration file to *files/conf* in your working directory. This file will be mounted as a configMap to the containers and it will be used for configuring InfluxDB.

Alternatively, you can specify the InfluxDB configuration using the influxdb.configuration parameter.

In addition to these options, you can also set an external ConfigMap with all the configuration files. This is done by setting the influxdb.existingConfiguration parameter. Note that this will override the two previous options.