<%
=begin
apps: rabbitmq
platforms: kubernetes
id: production_configuration
title: Production configuration
category: configuration
weight: 20
highlight: 20
=end %>

This chart includes a *values-production.yaml* file where you can find some parameters oriented to production configuration in comparison to the regular *values.yaml*. You can use this file instead of the default one.

* Resource needs and limits to apply to the pod:

    - resources: {}
    + resources:
    +   requests:
    +     memory: 256Mi
    +     cpu: 100m

* Replica count:

    - replicas: 1
    + replicas: 3

* Node labels for pod assignment:
 
    - nodeSelector: {}
    + nodeSelector:
    +   beta.kubernetes.io/arch: amd64

* Enable ingress with TLS:

    - ingress.tls: false
    + ingress.tls: true

* Start a side-car Prometheus exporter:

    - metrics.enabled: false
    + metrics.enabled: true

* Enable init container that changes volume permissions in the data directory:

    - volumePermissions.enabled: false
    + volumePermissions.enabled: true

To horizontally scale this chart once it has been deployed you have two options:

* Use *kubectl scale* command
* Upgrading the chart with the following parameters:

  ~~~
  replicas=3
  rabbitmq.password="$RABBITMQ_PASSWORD"
  rabbitmq.erlangCookie="$RABBITMQ_ERLANG_COOKIE"
  ~~~

> NOTE: Please note it's mandatory to indicate the password and erlangCookie that was set the first time the chart was installed to upgrade the chart. Otherwise, new pods won't be able to join the cluster.
