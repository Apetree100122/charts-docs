<%
=begin
apps: drupal
platforms: kubernetes
id: chart_persistence
title: Persistence volumes
category: configuration
weight: 40
highlight: 40
=end %>

The [Bitnami Drupal image](https://github.com/bitnami/bitnami-docker-drupal) stores the Drupal data at the /bitnami/drupal path of the container. If you wish to override the image value, and your image stores this data in different path, you may specify these paths with volumeMounts.drupal.mountPath.

Persistent Volume Claims are used to keep the data across deployments. This is known to work in GCE, AWS, and minikube. See the [Parameters section](https://github.com/bitnami/charts/tree/master/bitnami/drupal#parameters) to configure the PVC or to disable persistence.

### Existing PersistentVolumeClaim

* Create the PersistentVolume
* Create the PersistentVolumeClaim
* Install the chart

    $ helm install my-release --set persistence.drupal.existingClaim=PVC_NAME bitnami/drupal

### Host path

#### System compatibility

* The local filesystem accessibility to a container in a pod with hostPath has been tested on OS X/macOS with xhyve, and Linux with VirtualBox.
* Windows has not been tested with the supported VM drivers. Minikube does however officially support [Mounting Host Folders](https://github.com/kubernetes/minikube/blob/master/docs/host_folder_mount.md) per pod. Or you may manually sync your container whenever host files are changed with tools like [docker-sync](https://github.com/EugenMayer/docker-sync) or [docker-bg-sync](https://github.com/cweagans/docker-bg-sync).

#### Mounting steps

* The specified hostPath directory must already exist (create one if it does not).

* Install the chart

    $ helm install my-release --set persistence.drupal.hostPath=/PATH/TO/HOST/MOUNT bitnami/drupal

This will mount the drupal-data volume into the *hostPath* directory. The site data will be persisted if the mount path contains valid data, else the site data will be initialized at first launch.

* Because the container cannot control the host machine's directory permissions, you must set the Drupal file directory permissions yourself and disable or clear Drupal cache. See Drupal Core's [*INSTALL.txt*](https://git.drupalcode.org/project/drupal/blob/8.3.x/core/INSTALL.txt#n152) for setting file permissions, and see [Drupal handbook page](https://www.drupal.org/node/2598914) to disable the cache, or [Drush handbook](https://drushcommands.com/drush-8x/cache/cache-rebuild/) to clear cache.
